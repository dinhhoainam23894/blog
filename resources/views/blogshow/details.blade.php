@extends('blogshow.header-footer')
@section('container')
	<div class="container">
	<div class="wrapsite-content">
		<div class="main-content">
			<div class="content-left col-md-8">
				<div class="post-outer">
					<article class="post hentry">
						<a content="https://3.bp.blogspot.com/-3R4JgtYtDkw/WL_f5OAn-MI/AAAAAAAACjo/5ekt3ugDiE0HG4WONhioLPaIy1Nl6LmyACLcB/s1600/apple-iphone-books-desk.jpg"></a>
						<h1 class="post-title entry-title">
							{{ $data_id['title'] }}
						</h1>
						<div class="post-info">
						<span class="author-info">
						<img id="avatar" alt="" class="author-photo" height="32" itemprop="image" src="{{url("$user->avatar")}}" title="{{ $user->name }}" width="32">
						<span class="vcard" itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person">
						<span class="fn">
						<a class="g-profile" href="https://plus.google.com/106651422636219211057" rel="author" title="author profile" data-gapiscan="true" data-onload="true" data-gapiattached="true">
						<span id="username">{{ $user->name }}</span>
						</a>
						</span>
						</span>
						</span>
						<i aria-hidden="true" class="fa fa-clone"></i>
						<span class="time-info">
						<a class="timestamp-link" href="https://bayna-msdesignbd.blogspot.com/2017/03/what-would-you-have-to-give-up-to-pay.html" rel="bookmark" title="permanent link"><abbr class="published updated" title="">{{ $data_id['created_at'] }}</abbr></a>
						</span>
						<i aria-hidden="true" class="fa fa-clone"></i>
						<span class="comment-info">
						<a href="#">
						1 Comment
						</a>
						</span>
						<i aria-hidden="true" class="fa fa-clone"></i>
						<span class="label-info"> 
						Tags: 
						<a href="" rel="tag">Content Marketing</a>
						<a href="" rel="tag">News</a>
						<a href="" rel="tag">Related</a>
						</span>
						</div>
						<div class="share-box">
						<div class="a2a_kit a2a_default_style" style="line-height: 16px;">
						<span style="float: left; margin-right: 10px; font-size: 13px; font-family: roboto; font-weight: 500; margin-top: 2px; border-right: 1px solid #ddd; padding-right: 10px;"><i aria-hidden="true" class="fa fa-share-alt"></i> Like Me</span>
						<a class="a2a_button_facebook_like" style="width: 90px;"><div class="fb-like fb_iframe_widget" data-href="https://bayna-msdesignbd.blogspot.com/2017/03/what-would-you-have-to-give-up-to-pay.html" data-width="90" data-layout="button_count" data-ref="addtoany" fb-xfbml-state="rendered" fb-iframe-plugin-query="app_id=0&amp;container_width=0&amp;href=https%3A%2F%2Fbayna-msdesignbd.blogspot.com%2F2017%2F03%2Fwhat-would-you-have-to-give-up-to-pay.html&amp;layout=button_count&amp;locale=en_US&amp;ref=addtoany&amp;sdk=joey&amp;width=90"><span style="vertical-align: bottom; width: 78px; height: 20px;"><iframe name="f3e727ae651ee1" width="90px" height="1000px" frameborder="0" allowtransparency="true" allowfullscreen="true" scrolling="no" title="fb:like Facebook Social Plugin" src="https://www.facebook.com/plugins/like.php?app_id=0&amp;channel=https%3A%2F%2Fstaticxx.facebook.com%2Fconnect%2Fxd_arbiter%2Fr%2F1FegrZjPbq3.js%3Fversion%3D42%23cb%3Df33b53c224c808c%26domain%3Dbayna-msdesignbd.blogspot.com%26origin%3Dhttps%253A%252F%252Fbayna-msdesignbd.blogspot.com%252Ff11287e439ef11%26relation%3Dparent.parent&amp;container_width=0&amp;href=https%3A%2F%2Fbayna-msdesignbd.blogspot.com%2F2017%2F03%2Fwhat-would-you-have-to-give-up-to-pay.html&amp;layout=button_count&amp;locale=en_US&amp;ref=addtoany&amp;sdk=joey&amp;width=90" style="border: none; visibility: visible; width: 78px; height: 20px;" class=""></iframe></span></div></a>
						<a class="a2a_button_google_plusone"><div id="___plusone_0" style="text-indent: 0px; margin: 0px; padding: 0px; background: transparent; border-style: none; float: none; line-height: normal; font-size: 1px; vertical-align: baseline; display: inline-block; width: 90px; height: 20px;"><iframe ng-non-bindable="" frameborder="0" hspace="0" marginheight="0" marginwidth="0" scrolling="no" style="position: static; top: 0px; width: 90px; margin: 0px; border-style: none; left: 0px; visibility: visible; height: 20px;" tabindex="0" vspace="0" width="100%" id="I0_1490281623269" name="I0_1490281623269" src="https://apis.google.com/u/0/se/0/_/+1/fastbutton?usegapi=1&amp;size=medium&amp;annotation=bubble&amp;hl=en&amp;origin=https%3A%2F%2Fbayna-msdesignbd.blogspot.com&amp;url=https%3A%2F%2Fbayna-msdesignbd.blogspot.com%2F2017%2F03%2Fwhat-would-you-have-to-give-up-to-pay.html&amp;gsrc=3p&amp;ic=1&amp;jsh=m%3B%2F_%2Fscs%2Fapps-static%2F_%2Fjs%2Fk%3Doz.gapi.vi.SNwlzHbfUw4.O%2Fm%3D__features__%2Fam%3DAQ%2Frt%3Dj%2Fd%3D1%2Frs%3DAGLTcCOdMNCWZVbDFmI24Xuq4eitb9M65g#_methods=onPlusOne%2C_ready%2C_close%2C_open%2C_resizeMe%2C_renderstart%2Concircled%2Cdrefresh%2Cerefresh%2Conload&amp;id=I0_1490281623269&amp;parent=https%3A%2F%2Fbayna-msdesignbd.blogspot.com&amp;pfname=&amp;rpctoken=27195892" data-gapiattached="true" title="+1"></iframe></div></a>
						<div style="float:left;">
							<iframe id="twitter-widget-0" scrolling="no" frameborder="0" allowtransparency="true" class="twitter-share-button twitter-share-button-rendered twitter-tweet-button" title="Twitter Tweet Button" src="https://platform.twitter.com/widgets/tweet_button.89bd237a86eeb0e8b1de842a4b88b09b.en.html#dnt=false&amp;id=twitter-widget-0&amp;lang=en&amp;original_referer=https%3A%2F%2Fbayna-msdesignbd.blogspot.com%2F2017%2F03%2Fwhat-would-you-have-to-give-up-to-pay.html&amp;size=m&amp;text=What%20You%20Have%20to%20Give%20Up%20to%20Pay%20for%20An%20Unexpected%20Hospital%20Visit%3F&amp;time=1490281622083&amp;type=share&amp;url=https%3A%2F%2Fbayna-msdesignbd.blogspot.com%2F2017%2F03%2Fwhat-would-you-have-to-give-up-to-pay.html&amp;via=msubelbd" style="position: static; visibility: visible; width: 61px; height: 20px;" data-url="https://bayna-msdesignbd.blogspot.com/2017/03/what-would-you-have-to-give-up-to-pay.html">
								
							</iframe>
							<script async="async" src="//platform.twitter.com/widgets.js" type="text/javascript"></script>
						</div>
							<script async="async" src="//static.addtoany.com/menu/page.js" type="text/javascript"></script>
							<div style="clear: both;"></div>
						</div></div>
						<div class="post-body entry-content" id="post-body-2775771268752654827">
						{{ $data_id['content']}}<br>
						<div>
						<br>
						<div class="separator" style="clear: both; text-align: center;">
						<a href="https://3.bp.blogspot.com/-3R4JgtYtDkw/WL_f5OAn-MI/AAAAAAAACjo/5ekt3ugDiE0HG4WONhioLPaIy1Nl6LmyACLcB/s1600/apple-iphone-books-desk.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img alt="What Would You Have to Give Up to Pay for An Unexpected Hospital Visit?" border="0" src="{{url("$data_id->image")}}" title="What Would You Have to Give Up to Pay for An Unexpected Hospital Visit?"></a></div>
						<br>
						<a href="{{ route('blog.edit',$data_id['id']) }}" class="btn btn-warning pull-left">Edit</a>
						
						<form action="{{ route('blog.destroy',$data_id['id']) }}" method="post" accept-charset="utf-8">
							{{csrf_field()}}
		        			<input type="submit" name="" value="DELETE" class="btn btn-danger">
		        			<input type="hidden" name="_method" value="DELETE">
		    			</form>
					</article>
				</div>
				<div class="comments">
				<h4><i class="fa fa-comments-o"></i>
					2 comments:</h4>
					<div id="showComments">
						@foreach($comment as $list)
						<div id="task{{ $list->id }}" class="details-comment">
							<p style="display: none">{{ $avatar = $list->user }}</p>
							<img src="{{url("$avatar->avatar")}}"><span class="comment-header">{{ $list->user->name }}</span> <p class="cmt">{{$list->comments}}</p> <br>
							@if (Auth::User()->id == $list->user->id)
								<div class="cmt-edit">
									<textarea type="text" name="new-cmt" class="new-cmt" cols="50" rows="2">{{$list->comments}}</textarea> 
									<button type="button" class="save" value="{{ $list->id }}">save</button>
								</div>
								<button type="button" class="edit" value="{{ $list->id }}">edit</button>
							@endif
							
							<button type="button" class="close" value="{{ $list->id }}">X</button>
							
						</div>
						@endforeach
					</div>
					<br>
					<div id="commentsHolder">
	        		 <form id="form" action="{{route('comment',$data_id['id'])}}" method="POST">
	        		 	{{csrf_field()}}
	        		 	<textarea name="comments" id="comments" cols="50" rows="5" placeholder="enter your comment....."></textarea>
	        		 	<button type="button" class="btn btn-primary" id="btn-save" value="add">Save changes</button>
	        		 </form>
	        		</div>
	        	</div>

			</div>
			@include('blogshow.first_recent')

		</div>
		
	</div>
</div>
<meta name="_token" content="{!! csrf_token() !!}" />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script>
$(document).ready(function(){
		$.ajaxSetup({
            headers: {
                'X-CSRF-TOKEN': $('meta[name="_token"]').attr('content')
            }
        })
		$(document.body).on('click','#btn-save',function(){
			var cmt  = $('#comments').val();
			var url = $('#form').attr('action');
			var id = {{$user->id}};
			var name = $('#username').html();
			var avatar = $('#avatar').attr('src');
			 $.ajax({
			 	type : "POST",
			 	url  : url,
			 	data : {'comments':cmt,'id':id,'name':name,'avatar':avatar},
			 	dataType : 'JSON',
			 	success: function(data){
			 		console.log(data);
			 		$('#showComments').append("<div id='task"+data.id+"' class='details-comment'><img src='"+data.avatar+"'><span class='comment-header'>"+data.name+":</span> <p class='cmt'>"+data.comments+"</p><div class='cmt-edit'><textarea type='text' name='new-cmt' class='new-cmt' cols='50' rows='2'>"+data.comments+"</textarea><button type='button' class='save' value='"+data.id+"'>save</button></div><button type='button' class='edit' value='"+data.id+"'>edit</button><button type='button' class='edit' value='"+data.id+"'>edit</button><button type='button' class='close' value='"+data.id+"'>X</button></div></br>"); 
			 		$('#comments').val("");  
			 	}
			 });
		});

		$(document.body).on('click','.close',function(){
			var id = $(this).val();
			$.ajax({
			 	type : "DELETE",
			 	url  : "/delete/"+id,
			 	dataType : "JSON",
			 	data : {'id':id},
			 	success: function(data){
			 		console.log(data);
			 		$("#task"+id).remove();
			 	},
            	error: function (data) {
                console.log('Error:', data);
            	}
			 });
		});
		$(document.body).on('click','.edit',function(){
			$(this).parents('.details-comment').children('.cmt-edit').show();
		});
		$(document.body).on('click','.cmt',function(){
			$(this).parents('.details-comment').children('.cmt-edit').show();
		});
		$(document.body).on('click','.save',function(){
			
			var id = $(this).val();
			var newcmt = $(this).parents(".cmt-edit").children('.new-cmt').val();

			$.ajax({
				type 	: "PUT",
				url 	: "/edit/"+id,
				dataType: "JSON",
				data 	:{'id':id,'user':{{Auth::User()->id}},'comment':newcmt},
				success: function(data){
					console.log(data);
					$('#task'+data.id).children('.cmt').html(data.comment);
				},
				error: function(data) {
					console.log('Error:', data);
				}	
			});
			$('.cmt-edit').hide();
		});
	});
</script>				
				
@endsection